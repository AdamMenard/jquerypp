<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>StaticMatic</title>
    <link rel="stylesheet/less" type="text/css" href="stylesheets/styles.less">
    <script src="javascripts/less-1.2.1.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="javascripts/highlightjs/src/styles/github.css">
  </head>
  <body>
    <div id='bg'></div>
    <div class='cf' id='wrapper'>
      <div id='menu-wrapper'>
        <div id='header'>
          <div id='logo-and-download'>
            <img alt="Logo" id="logo" src="images/logo.png"/>
            <a class='primary' href='#'>Download v3.3.3</a>
          </div>
        </div>
        <div class='cf' id='buttons'>
          <a href='#'>Visit Forums</a>
          <a href='#'>Fork on Github</a>
        </div>
        <ul id='menu'></ul>
        <a href='#' id='developed-by'>
          <img alt="Bitovi" src="images/bitovi.png"/>
        </a>
      </div>
      <div id='content-wrapper'>
        <div id='content'>
          <h1>Rapid start guide</h1>
          <p>This walks through the basics of JavaScriptMVC by building a 
          smal todo app.  Check out the <a href="#%21getstarted">Getting Started Guide</a> 
          for a more in-depth overview.</p>
          
          <h2>Get JavaScriptMVC</h2>
          
          <p><a href="http://javascriptmvc.com/builder.html">Download it</a> or 
          <a href="#%21developwithgit">pull it from Git</a>.  JavaScriptMVC (JMVC) is a collection of 4 sub-projects. 
          Once you have JavaScriptMVC, you should have a folder with:</p>
          
          <pre><code class=" javascript">documentjs - documentation engine&#x000A;funcunit   - testing app&#x000A;jquery     - jquery and jQueryMX plugins&#x000A;steal      - dependency management&#x000A;js         - JS command line <span class="keyword">for</span> Linux/Mac&#x000A;js.bat     - JS command line <span class="keyword">for</span> Windows&#x000A;</code></pre>
          
          <p><b>Notice</b>: This folder, the one that has the sub-projects, is 
          called the <a href="#%21rootfolder">ROOT FOLDER</a>.</p>
          
          <h2>Get JavaScriptMVC running.</h2>
          
          <p>JMVC uses <a href="#%21steal">steal/steal.js</a> for dependency 
          management. Steal loads scripts.  To use JavaScriptMVC's 
          features like <a href="#%21jQuery.Controller">$.Controller</a> and <a href="#%21jQuery.View">$.View</a>,
          'steal' them like:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'jquery/controller'</span>,<span class="string">'jquery/view/ejs'</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;   <span class="comment">//code that uses controller and view goes here</span>&#x000A;})&#x000A;</code></pre>
          
          <p>To use steal, you need to add the steal script to 
          your page. In the <a href="#%21rootfolder">root folder</a> create a <strong>todos</strong> folder
          and empty <strong>todos.html</strong> and <strong>todos.js</strong> that look like:</p>
          
          <pre><code class=" javascript">ROOT\&#x000A;    documentjs\&#x000A;    jquery\&#x000A;    funcunit\&#x000A;    steal\&#x000A;    todos\&#x000A;      todos.js&#x000A;      todos.html&#x000A;</code></pre>
          
          <p>To load <em>steal.js</em> and <em>todos.js</em>, make <strong>todos.html</strong> look like:</p>
          
          <pre><code class=" javascript">&lt;!DOCTYPE html&gt;&#x000A;&lt;html&gt;&#x000A;&lt;head&gt;&lt;/head&gt;&#x000A;&lt;body&gt;&#x000A;  &lt;ul id=<span class="string">'todos'</span>&gt;&lt;/ul&gt;&#x000A;  &lt;input id=<span class="string">'editor'</span>/&gt;&#x000A;  &lt;script type=<span class="string">'text/javascript'</span>&#x000A;          src=<span class="string">'../steal/steal.js?todos/todos.js'</span>&gt;&#x000A;  &lt;/script&gt;&#x000A;&lt;/body&gt;&#x000A;&lt;/html&gt;&#x000A;</code></pre>
          
          <p>Open the page in your browser.  Use a debugger like firebug to see <em>steal.js</em> and
          <em>todos.js</em> loading.</p>
          
          <h2>steal <code>steal([paths])</code></h2>
          
          <p><a href="#%21steal">steal</a> is used to load scripts, styles, even CoffeeScript, LESS
          and templates into your application.  </p>
          
          <p>Path are assumed to be relative to the <a href="#%21rootfolder">root folder</a>. This
          means that the following always loads <code>jquery/class/class.js</code>
          no matter which file is calling steal:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'jquery/class/class.js'</span>);&#x000A;</code></pre>
          
          <p>You can load relative to the current file by adding <code>./</code> to the
          start of your path like:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'./helpers.js'</span>)&#x000A;</code></pre>
          
          <p>Steal also supports css, allowing you to steal <code>todos/todos.css</code> 
          like:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'./todos.css'</span>)&#x000A;</code></pre>
          
          <p>Because loading paths like <code>jquery/class/class.js</code> is so 
          common, if you do not provide an extension like <code>.js</code>, steal 
          will append the last folder name and <code>.js</code>. This makes
          the following load <code>jquery/class/class.js</code>:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>)&#x000A;</code></pre>
          
          <p>Steal is an asynchronous loader, so you can't do:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>)&#x000A;$.Class&#x000A;</code></pre>
          
          <p>Instead, do:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;  $.Class&#x000A;})&#x000A;</code></pre>
          
          <p>For this application, we will load jQueryMX's most
          common plugins.  Add the following to <strong>todos.js</strong>:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>,&#x000A;      <span class="string">'jquery/model'</span>,&#x000A;      <span class="string">'jquery/dom/fixture'</span>,&#x000A;      <span class="string">'jquery/view/ejs'</span>,&#x000A;      <span class="string">'jquery/controller'</span>,&#x000A;      <span class="string">'jquery/controller/route'</span>,&#x000A;      <span class="function"><span class="keyword">function</span><span class="params">($)</span>{</span>&#x000A;&#x000A;})&#x000A;</code></pre>
          
          <p>The following goes through each plugin while we build the todos app.</p>
          
          <h2>$.Class <code>$.Class([name,] [classProps,] [prototypeProps])</code></h2>
          
          <p>Constructors made with <a href="#%21jQuery.Class">$.Class</a> are used to create
          objects with shared properties. It's used by both
          <strong>$.Controller</strong> and <strong>$.Model</strong>.</p>
          
          <p>To create a <strong>Class</strong> of your own, call <strong>$.Class</strong> with the:</p>
          
          <ul>
          <li><strong>name</strong> of the class which can be used for introspection,</li>
          <li><strong>classProperties</strong> that are attached directly to the constructor, and</li>
          <li>instance <strong>prototypeProperties</strong>.</li>
          </ul>
          
          <p><strong>$.Class</strong> sets up the prototype chain so subclasses can be further 
          extended and sub-classed as far as you like:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;&#x000A;  $.Class(<span class="string">"Todo"</span>,{&#x000A;    init : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>},&#x000A;&#x000A;    author : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> ... },&#x000A;&#x000A;    coordinates : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> ... },&#x000A;&#x000A;    allowedToEdit: <span class="function"><span class="keyword">function</span><span class="params">(account)</span> {</span> &#x000A;     <span class="keyword">return</span> <span class="literal">true</span>;&#x000A;    }&#x000A;  });&#x000A;&#x000A;  Todo(<span class="string">'PrivateTodo'</span>,{&#x000A;    allowedToEdit: <span class="function"><span class="keyword">function</span><span class="params">(account)</span> {</span>&#x000A;      <span class="keyword">return</span> account.owns(<span class="keyword">this</span>);&#x000A;    }&#x000A;  })&#x000A;&#x000A;});&#x000A;</code></pre>
          
          <p><em>Brief aside on <code>super</code>.  $.Class provides a 
          <code>_super</code> method to call the function of the same name higher 
          on the prototype chain like:</em></p>
          
          <pre><code class=" javascript"><span class="keyword">var</span> SecureNote = Todo({&#x000A;  allowedToEdit: <span class="function"><span class="keyword">function</span><span class="params">(account)</span> {</span>&#x000A;    <span class="keyword">return</span> <span class="keyword">this</span>._super(account) &amp;&amp; &#x000A;       <span class="keyword">this</span>.isSecure();&#x000A;  }&#x000A;})&#x000A;</code></pre>
          
          <h3>constructor / init <code>new Class(arg1, arg2)</code></h3>
          
          <p>When a class constructor is invoked, <strong>$.Class</strong> creates the instance and 
          calls <a href="#%21jQuery.Class.prototype.init">$.Class.prototype.init</a> with 
          the arguments passed to <code>new Class(...)</code>.</p>
          
          <pre><code class=" javascript">$.Class(<span class="string">'Todo'</span>,{&#x000A;  init : <span class="function"><span class="keyword">function</span><span class="params">(text)</span> {</span>&#x000A;    <span class="keyword">this</span>.text = text&#x000A;  },&#x000A;  read : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;    console.log(<span class="keyword">this</span>.text);&#x000A;  }&#x000A;})&#x000A;&#x000A;<span class="keyword">var</span> todo = <span class="keyword">new</span> Todo(<span class="string">"Hello World"</span>);&#x000A;todo.read()&#x000A;</code></pre>
          
          <p><em>Brief aside on <strong>init</strong>.  $.Class actually calls 
          <a href="#%21jQuery.Class.prototype.setup">$.Class.prototype.setup</a> before 
          init.  <code>setup</code> can be used to change (or normalize) the arguments passed to <strong>init</strong>.</em></p>
          
          <h2>Model <code>$.Model(name, classProperties, prototypeProperties)</code></h2>
          
          <p>Models are central to any application.  They 
          contain data and logic surrounding it.  You 
          extend <a href="#%21jQuery.Model">$.Model</a> with your domain specific 
          methods and $.Model provides a set of methods 
          for managing changes.</p>
          
          <p>To create a <strong>Model</strong> class, call <strong>$.Model</strong> with the:</p>
          
          <ul>
          <li><strong>name</strong> of the class,</li>
          <li><strong>classProperties</strong>, including 
          <a href="#%21jQuery.Model.static.findAll">findAll</a>,
          <a href="#%21jQuery.Model.static.findAll">findOne</a>,
          <a href="#%21jQuery.Model.static.create">create</a>,
          <a href="#%21jQuery.Model.static.update">update</a>,
          <a href="#%21jQuery.Model.static.destroy">destroy</a> properties, and</li>
          <li>prototype instance properties.</li>
          </ul>
          
          <p>Make a Todo model in <strong>todos.js</strong> like the following:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>,&#x000A;      <span class="string">'jquery/controller'</span>,&#x000A;      <span class="string">'jquery/model'</span>,&#x000A;      <span class="string">'jquery/view/ejs'</span>,&#x000A;      <span class="string">'jquery/dom/fixture'</span>,&#x000A;      <span class="function"><span class="keyword">function</span><span class="params">($)</span>{</span>&#x000A;&#x000A;  $.Model(<span class="string">'Todo'</span>,{&#x000A;    findAll : <span class="string">"GET /todos"</span>,&#x000A;    findOne : <span class="string">"GET /todos/{id}"</span>,&#x000A;    create  : <span class="string">"POST /todos"</span>,&#x000A;    update  : <span class="string">"PUT /todos/{id}"</span>,&#x000A;    destroy : <span class="string">"DELETE /todos/{id}"</span>&#x000A;  },&#x000A;  {})&#x000A;});&#x000A;</code></pre>
          
          <p><strong>Note:</strong> Try the following commands in your browser:</p>
          
          <h3>new $.Model(attributes)</h3>
          
          <p>Create a todo instance like:</p>
          
          <pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo({name: <span class="string">"do the dishes"</span>});&#x000A;</code></pre>
          
          <h3>attr <code>model.attr( name, [value] )</code></h3>
          
          <p><a href="#%21jQuery.Model.prototype.attr">$.Model.prototype.attr</a> reads or sets properties on model instances.</p>
          
          <pre><code class=" javascript">todo.attr(<span class="string">'name'</span>) <span class="comment">//-&gt; "do the dishes"</span>&#x000A;&#x000A;todo.attr(<span class="string">'name'</span>, <span class="string">"wash the dishes"</span> );&#x000A;&#x000A;todo.attr() <span class="comment">//-&gt; {name: "wash the dishes"}</span>&#x000A;&#x000A;todo.attr({name: <span class="string">"did the dishes"</span>});&#x000A;</code></pre>
          
          <h3>Talking to the server</h3>
          
          <p>Model uses static <a href="#%21jQuery.Model.static.findAll">findAll</a>,
          <a href="#%21jQuery.Model.static.findAll">findOne</a>, <a href="#%21jQuery.Model.static.create">create</a>,
          <a href="#%21jQuery.Model.static.update">update</a>, and <a href="#%21jQuery.Model.static.destroy">destroy</a>
          methods to create, read, update and delete 
          model instances on the server.  </p>
          
          <p>Now you can call methods on Todo that
          make changes on the server.  For example, 
          in your console, try:</p>
          
          <pre><code class=" javascript">Todo.findAll({});&#x000A;</code></pre>
          
          <p>In the console, you'll see it make a request 
          to <code>GET /todos</code>.</p>
          
          <p>Assuming your server does not have a <code>/todos</code> service,
          this won't work.  That's ok, we can simulate them with
          <a href="#%21%24.fixture">$.fixture</a>.</p>
          
          <h3>$.fixture <code>$.fixture(url, fixture(original, settings, headers) )</code></h3>
          
          <p>Fixtures simulate requests to a specific 
          url.  The <code>fixture</code> function is called with:</p>
          
          <ul>
          <li><strong>original</strong> - original settings passed to $.ajax</li>
          <li><strong>settings</strong> - settings normalized by $.ajax</li>
          <li><strong>headers</strong> - request headers</li>
          </ul>
          
          <p>And, it's expected to return an array of the arguments
          passed to jQuery's ajaxTransport <code>completeCallback</code> system:</p>
          
          <pre><code class=" javascript"><span class="keyword">return</span> [ status, statusText, responses, responseHeaders ];&#x000A;</code></pre>
          
          <p>This might look like:</p>
          
          <pre><code class=" javascript"><span class="keyword">return</span> [ <span class="number">200</span>, <span class="string">"success"</span>, {json: []}, {} ];&#x000A;</code></pre>
          
          <p>If the array only has one item, it's assumed to be the json
          data.  </p>
          
          <p>To simulate the todo services, add the following within the
          steal callback:</p>
          
          <pre><code class=" javascript"><span class="comment">// our list of todos</span>&#x000A;<span class="keyword">var</span> TODOS = [&#x000A;    {id: <span class="number">1</span>, name: <span class="string">"wake up"</span>},&#x000A;    {id: <span class="number">2</span>, name: <span class="string">"take out trash"</span>},&#x000A;    {id: <span class="number">3</span>, name: <span class="string">"do dishes"</span>}&#x000A;];&#x000A;<span class="comment">// findAll</span>&#x000A;$.fixture(<span class="string">"GET /todos"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;  <span class="keyword">return</span> [TODOS]&#x000A;});&#x000A;&#x000A;<span class="comment">// findOne</span>&#x000A;$.fixture(<span class="string">"GET /todos/{id}"</span>, <span class="function"><span class="keyword">function</span><span class="params">(orig)</span>{</span>&#x000A;  <span class="keyword">return</span> TODOS[(+orig.data.id)-<span class="number">1</span>];&#x000A;})&#x000A;&#x000A;<span class="comment">// create</span>&#x000A;<span class="keyword">var</span> id= <span class="number">4</span>;&#x000A;$.fixture(<span class="string">"POST /todos"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;  <span class="keyword">return</span> {id: (id++)}&#x000A;})&#x000A;&#x000A;<span class="comment">// update</span>&#x000A;$.fixture(<span class="string">"PUT /todos/{id}"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;  <span class="keyword">return</span> {};&#x000A;})&#x000A;&#x000A;<span class="comment">// destroy</span>&#x000A;$.fixture(<span class="string">"DELETE /todos/{id}"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;  <span class="keyword">return</span> {};&#x000A;})&#x000A;</code></pre>
          
          <p>Now you can use Model's ajax methods to CRUD todos.</p>
          
          <h3>findAll <code>findAll( params, success( todos ), error() )</code></h3>
          
          <p><a href="#%21jQuery.Model.static.findAll">findAll</a> retrieves multiple todos:</p>
          
          <pre><code class=" javascript">Todo.findAll({}, <span class="function"><span class="keyword">function</span><span class="params">( todos )</span> {</span>&#x000A;  console.log( todos );&#x000A;})&#x000A;</code></pre>
          
          <h3>findOne <code>findOne( params, success( todo ), error() )</code></h3>
          
          <p><a href="#%21jQuery.Model.static.findOne">findOne</a> retrieves a single todo:</p>
          
          <pre><code class=" javascript">Todo.findOne({}, <span class="function"><span class="keyword">function</span><span class="params">( todo )</span> {</span>&#x000A;  console.log( todo );&#x000A;})&#x000A;</code></pre>
          
          <h3>save <code>todo.save( success( todo ), error() )</code></h3>
          
          <p><a href="#%21jQuery.Model.prototype.save">Save</a> can <strong>create</strong> 
          or <strong>update</strong> instances depending if the 
          instance has already been created or not.</p>
          
          <p>To <strong>create</strong> a todo on the server, create a
          todo instance and call <strong>save</strong> like the following:</p>
          
          <pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo({name: <span class="string">"mow lawn"</span>})&#x000A;todo.save(<span class="function"><span class="keyword">function</span><span class="params">(todo)</span>{</span>&#x000A;  console.log( todo );&#x000A;})&#x000A;</code></pre>
          
          <p>To <strong>update</strong> a todo on the server, change the attributes
          and call <strong>save</strong> again like the following:</p>
          
          <pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo({name: <span class="string">"mow lawn"</span>});&#x000A;todo.save( <span class="function"><span class="keyword">function</span><span class="params">(todo)</span>{</span>&#x000A;  console.log(<span class="string">"created"</span>, todo );&#x000A;&#x000A;  todo.attr(<span class="string">"name"</span>, <span class="string">"mow my lawn"</span>)&#x000A;  todo.save( <span class="function"><span class="keyword">function</span><span class="params">( todo )</span> {</span>&#x000A;    console.log(<span class="string">"updated"</span>, todo );&#x000A;  })&#x000A;})&#x000A;</code></pre>
          
          <h3>destroy <code>todo.destroy( success( todo ), error() )</code></h3>
          
          <p><a href="#%21jQuery.Model.prototype.destroy">Destroy</a> deletes a 
          record on the server.  You can do this like:</p>
          
          <pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo({name: <span class="string">"mow lawn"</span>});&#x000A;todo.save( <span class="function"><span class="keyword">function</span><span class="params">(todo)</span>{</span>&#x000A;  console.log(<span class="string">"created"</span>, todo );&#x000A;&#x000A;  todo.destroy( <span class="function"><span class="keyword">function</span><span class="params">( todo )</span> {</span>&#x000A;    console.log(<span class="string">"destroyed"</span>, todo );&#x000A;  })&#x000A;})&#x000A;</code></pre>
          
          <h3>bind <code>todo.bind( event, handler(ev, todo ) )</code></h3>
          
          <p>Listening to changes in the Model is what MVC 
          is about.  Model lets you <a href="#%21jQuery.Model.prototype.bind">bind</a> to changes 
          on an individual instance 
          or <a href="#%21jQuery.Model.static.bind">all instances</a>. For example, you can listen to 
          when an instance is <strong>created</strong> on the server like:</p>
          
          <pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo({name: <span class="string">"mow lawn"</span>});&#x000A;todo.bind(<span class="string">'created'</span>, <span class="function"><span class="keyword">function</span><span class="params">(ev, todo)</span>{</span>&#x000A;  console.log(<span class="string">"created"</span>, todo );&#x000A;})&#x000A;todo.save()&#x000A;</code></pre>
          
          <p>You can listen to anytime an <strong>instance</strong> is created on the server by 
          binding on the model:</p>
          
          <pre><code class=" javascript">Todo.bind(<span class="string">'created'</span>, <span class="function"><span class="keyword">function</span><span class="params">(ev, todo)</span>{</span>&#x000A;  console.log(<span class="string">"created"</span>, todo );&#x000A;})&#x000A;</code></pre>
          
          <p>Model produces the following events on 
          the model class and instances whenever a model Ajax request completes:</p>
          
          <ul>
          <li><strong>created</strong> - an instance is created on the server</li>
          <li><strong>updated</strong> - an instance is updated on the server</li>
          <li><strong>destroyed</strong> - an instance is destroyed on the server</li>
          </ul>
          
          <h3>$.fn.model <code>$(el).model([modelInstance])</code></h3>
          
          <p>It can be helpful to label an element with a model instance
          so it can be retrieved later. <a href="#%21jQuery.fn.model">jQuery.fn.model</a> is used
          to get and set a model instance on an element.</p>
          
          <p>To set an instance:</p>
          
          <pre><code class=" javascript"><span class="keyword">var</span> li = $(<span class="string">'&lt;li&gt;'</span>).model( <span class="keyword">new</span> Todo({id: <span class="number">5</span>}) )&#x000A;                  .appendTo(<span class="string">"#todos"</span>);&#x000A;</code></pre>
          
          <p>This will add <strong>'todo todo_5'</strong> to the <code>&lt;li&gt;</code>'s className. We can
          get back the model instance with:</p>
          
          <pre><code class=" javascript">li.model().id <span class="comment">//-&gt; 5</span>&#x000A;</code></pre>
          
          <h3>elements <code>todo.elements( [context] )</code></h3>
          
          <p><a href="#%21jQuery.Model.prototype.elements">Elements</a> retrieves the elements that 
          have a model instance. A <strong>context</strong> element (or query string) can be 
          provided to limit the search to within a particular element:</p>
          
          <pre><code class=" javascript">todo.elements(<span class="string">'#todos'</span>);&#x000A;</code></pre>
          
          <h2>View <code>$.View( idOrUrl, data )</code></h2>
          
          <p><a href="#%21jQuery.View">$.View</a> is used to easily create HTML with
          JS templates. Pass it ...</p>
          
          <ul>
          <li>the <strong>id</strong> of a script tag to use as the content of the template</li>
          <li><strong>data</strong> to pass to the template</li>
          </ul>
          
          <p>... and it returns the rendered result of the template.  For
          example, add the following to <strong>todos.html</strong>:</p>
          
          <pre><code class=" javascript">&lt;script type=<span class="string">'text/ejs'</span> id=<span class="string">'todosEJS'</span>&gt;&#x000A;  &lt;% <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.length; i++ ){ %&gt;&#x000A;    &lt;li&gt;&lt;%= <span class="keyword">this</span>[i].name %&gt;&lt;/li&gt;&#x000A;  &lt;% } %&gt;&#x000A;&lt;/script&gt;&#x000A;</code></pre>
          
          <p>Render a list of todos with:</p>
          
          <pre><code class=" javascript"> Todo.findAll( {}, <span class="function"><span class="keyword">function</span><span class="params">( todos )</span>{</span>&#x000A;     console.log( $.View( <span class="string">'todosEJS'</span>, todos ) );&#x000A; });&#x000A;</code></pre>
          
          <p>$.View also takes a <strong>url</strong> for a template location.  <strong>Create</strong> 
          a <em>todos/todos.ejs</em> file that contains the following:</p>
          
          <pre><code class=" javascript">&lt;% <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.length; i++ ){ %&gt;&#x000A;  &lt;li&gt;&lt;%= <span class="keyword">this</span>[i].name %&gt;&lt;/li&gt;&#x000A;&lt;% } %&gt;&#x000A;</code></pre>
          
          <p>Render this with:</p>
          
          <pre><code class=" javascript">Todo.findAll( {}, <span class="function"><span class="keyword">function</span><span class="params">( todos )</span>{</span>&#x000A;  console.log( $.View( <span class="string">'todos.ejs'</span>, todos ) );&#x000A;});&#x000A;</code></pre>
          
          <p><strong>$.View</strong> works with any template language, such
          as JAML, jQuery-tmpl, Mustache and superpowers them with:</p>
          
          <ul>
          <li>Loading from scripts and external files </li>
          <li>using templates with jQuery <strong>modifiers</strong> like html</li>
          <li>Template caching</li>
          <li>Deferred support</li>
          <li>Bundling processed templates in production builds</li>
          </ul>
          
          <h3>Modifiers - <code>el.<i>modifier</i>( idOrUrl, data )</code></h3>
          
          <p><strong>$.View</strong> overwrites the jQuery's html modifiers
          after, append, before, html, prepend, replaceWith, and text,
          allowing you to write:</p>
          
          <pre><code class=" javascript">Todo.findAll( {}, <span class="function"><span class="keyword">function</span><span class="params">( todos )</span>{</span>&#x000A;  $(<span class="string">'#todos'</span>).html( <span class="string">'todos.ejs'</span>, todos );&#x000A;});&#x000A;</code></pre>
          
          <p>To make this work, make sure <code>todos.html</code> has a <code>#todos</code> element like:</p>
          
          <pre><code class=" javascript">&lt;ul id=<span class="string">'todos'</span>&gt;&lt;/ul&gt;&#x000A;</code></pre>
          
          <h3>Deferreds</h3>
          
          <p><strong>$.Model</strong>'s ajax methods return a deffered. <strong>$.View</strong>
          accepts deferreds, making this hotness possible:</p>
          
          <pre><code class=" javascript">$(<span class="string">'#todos'</span>).html(<span class="string">'todos.ejs'</span>, Todo.findAll() )&#x000A;</code></pre>
          
          <p>This syntax will render todos.ejs with the todo instances in the AJAX request 
          made by Todo.findAll, whenever its completed.</p>
          
          <h3>Hookup <code>&lt;li &lt;%= (el)-&gt; CODE %&gt; &gt;</code></h3>
          
          <p><a href="#%21jQuery.View.hookup">$.View.hookup</a> lets you provide 
          <a href="http://wiki.ecmascript.org/doku.php?id=strawman:arrow%3Cem%3Efunction%3C/em%3Esyntax">ES5-style arrow function</a> 
          callbacks on elements in your template.  These callback functions
          get called after the template has been 
          inserted into the DOM. You can call jQuery methods on the element like:</p>
          
          <pre><code class=" javascript">&lt;li &lt;%= ($el) -&gt; $el.fadeIn() %&gt; style=<span class="string">'display:none'</span>&gt;&#x000A;  &lt;%= <span class="keyword">this</span>[i].name %&gt;&#x000A;&lt;/li&gt;&#x000A;</code></pre>
          
          <p>In your code, add a <strong>returning</strong>  magic tag (<code>&lt;%= %&gt;</code>) that 
          matches the <em>arrow function syntax</em>.  The argument passed to the function will
          be the jQuery-wrapped element.  </p>
          
          <p>This lets you hookup model data to elements in EJS.  Change <strong>todos.ejs</strong> to:</p>
          
          <pre><code class=" javascript">&lt;% $.each(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span><span class="params">(i, todo)</span>{</span> %&gt;&#x000A;  &lt;li &lt;%= ($el) -&gt; $el.model(todo) %&gt;&gt;&#x000A;    &lt;%= todo.name %&gt;&#x000A;    &lt;a href=<span class="string">"javascript://"</span> class=<span class="string">'destroy'</span>&gt;X&lt;/a&gt;&#x000A;  &lt;/li&gt;&#x000A;&lt;% }) %&gt;&#x000A;</code></pre>
          
          <h2>Controller <code>$.Controller(name, classProps, prototypeProps)</code></h2>
          
          <p><a href="#%21jQuery.Controller">$.Controller</a> creates organized, memory-leak free, 
          rapidly performing, stateful jQuery widgets. It is used to create UI controls like 
          tabs, grids, and contextmenus and used to organize them 
          into higher-order business rules with <a href="#%21jQuery.route">$.route</a>. Its serves as 
          both a traditional view and a 
          traditional controller.</p>
          
          <p>Let's make a basic todos widget that 
          lists todos and lets 
          us destroy them. Add the following to <strong>todos.js</strong>:</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{&#x000A;  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span>&#x000A;    <span class="keyword">this</span>.element.html(<span class="string">'todos.ejs'</span>, Todo.findAll() )&#x000A;  }&#x000A;})&#x000A;</code></pre>
          
          <p>We can create this widget on the <code>#todos</code> element with:</p>
          
          <pre><code class=" javascript"><span class="keyword">new</span> Todos(<span class="string">'#todos'</span>, {});&#x000A;</code></pre>
          
          <h3>init <code>$.Controller.prototype.init(element, options)</code></h3>
          
          <p><a href="#%21jQuery.Controller.prototype.init">Init</a> is called when a
          new Controller instance is created.  It's called with:</p>
          
          <ul>
          <li><strong>element</strong> - The jQuery wrapped element passed to the 
                        controller.  Controller accepts a jQuery element, a
                        raw HTMLElement, or a css selector.  This is
                        set as <strong>this.element</strong> on the controller instance.</li>
          <li><strong>options</strong> - The second argument passed to new Controller, extended with
                        the Controller's static <strong>defaults</strong>. This is set as 
                        <strong>this.options</strong> on the controller instance.</li>
          </ul>
          
          <p>and any other arguments passed to <code>new Controller()</code>.  For example:</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,&#x000A;{&#x000A;  defaults : {template: <span class="string">'todos.ejs'</span>}&#x000A;},&#x000A;{&#x000A;  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span>&#x000A;    element.html(options.template, Todo.findAll() )&#x000A;  }&#x000A;})&#x000A;&#x000A;<span class="keyword">new</span> Todos( document.body.firstElementChild );&#x000A;<span class="keyword">new</span> Todos( $(<span class="string">'#todos'</span>), {template: <span class="string">'specialTodos.ejs'</span>})&#x000A;</code></pre>
          
          <h3>element <code>this.element</code></h3>
          
          <p><a href="#%21jQuery.Controller.prototype.element">this.element</a> is the jQuery-wrapped
          element the controller is created on. </p>
          
          <h3>options <code>this.options</code></h3>
          
          <p><a href="#%21jQuery.Controller.prototype.options">this.options</a> is the second argument passed to 
          <code>new Controller()</code> merged with the controller's static <strong>defaults</strong> property.</p>
          
          <h3>Listening to events</h3>
          
          <p>Controller automatically binds prototype methods that look
          like event handlers.  Listen to <strong>click</strong>s on <code>&lt;li&gt;</code> elements like:</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{&#x000A;  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span>&#x000A;    <span class="keyword">this</span>.element.html(<span class="string">'todos.ejs'</span>, Todo.findAll() )&#x000A;  },&#x000A;  <span class="string">"li click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(li, event)</span>{</span>&#x000A;    console.log(<span class="string">"You clicked"</span>, li.text() )&#x000A;&#x000A;    <span class="comment">// let other controls know what happened</span>&#x000A;    li.trigger(<span class="string">'selected'</span>);&#x000A;  }&#x000A;})&#x000A;</code></pre>
          
          <p>When an <code>&lt;li&gt;</code> is clicked, <code>"li click"</code> is called with:</p>
          
          <ul>
          <li>The jQuery-wrapped <strong>element</strong> that was clicked</li>
          <li>The <strong>event</strong> data</li>
          </ul>
          
          <p>Controller uses event delegation, so you can add <code>&lt;li&gt;</code>s without needing to rebind
          event handlers.</p>
          
          <p>To destroy a todo when it's <code>&lt;a href='javascript:// class='destroy'&gt;</code> link 
          is clicked:</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{&#x000A;  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span>&#x000A;    <span class="keyword">this</span>.element.html(<span class="string">'todos.ejs'</span>, Todo.findAll() )&#x000A;  },&#x000A;  <span class="string">"li click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(li)</span>{</span>&#x000A;    li.trigger(<span class="string">'selected'</span>, li.model() );&#x000A;  },&#x000A;  <span class="string">"li .destroy click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span>&#x000A;    <span class="comment">// get the li element that has the model</span>&#x000A;    <span class="keyword">var</span> li = el.closest(<span class="string">'.todo'</span>);&#x000A;&#x000A;    <span class="comment">// get the model</span>&#x000A;    <span class="keyword">var</span> todo = li.model()&#x000A;&#x000A;    <span class="comment">//destroy it</span>&#x000A;    todo.destroy(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;      <span class="comment">// remove the element</span>&#x000A;      li.remove();&#x000A;    });&#x000A;  }&#x000A;})&#x000A;</code></pre>
          
          <h3>Templated Event Handlers Pt 1 <code>"{optionName}"</code></h3>
          
          <p>Customize event handler behavior with <code>"{NAME}"</code> in
          the event handler name.  The following allows customization 
          of the event that destroys a todo:</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{&#x000A;  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span> ... },&#x000A;  <span class="string">"li click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(li)</span>{</span> ... },&#x000A;&#x000A;  <span class="string">"li .destroy {destroyEvent}"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span> &#x000A;    <span class="comment">// previous destroy code here</span>&#x000A;  }&#x000A;})&#x000A;&#x000A;<span class="comment">// create Todos with this.options.destroyEvent</span>&#x000A;<span class="keyword">new</span> Todos(<span class="string">"#todos"</span>,{destroyEvent: <span class="string">"mouseenter"</span>})&#x000A;</code></pre>
          
          <p>Values inside <code>{NAME}</code> are looked up on the controller's <code>this.options</code>
          and then the <code>window</code>.  For example, we could customize it instead like:</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{&#x000A;  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span> ... },&#x000A;  <span class="string">"li click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(li)</span>{</span> ... },&#x000A;&#x000A;  <span class="string">"li .destroy {Events.destroy}"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span> &#x000A;    <span class="comment">// previous destroy code here</span>&#x000A;  }&#x000A;})&#x000A;&#x000A;<span class="comment">// Events config</span>&#x000A;Events = {destroy: <span class="string">"click"</span>};&#x000A;&#x000A;<span class="comment">// Events.destroy is looked up on the window.</span>&#x000A;<span class="keyword">new</span> Todos(<span class="string">"#todos"</span>)&#x000A;</code></pre>
          
          <p>The selector can also be templated.</p>
          
          <h3>Templated Event Handlers Pt 2 <code>"{objectName}"</code></h3>
          
          <p>Controller can also bind to objects other than <code>this.element</code> with
          templated event handlers.  This is <strong>especially critical</strong>
          for avoiding memory leaks that are so common among MVC applications.  </p>
          
          <p>If the value inside <code>{NAME}</code> is an object, that object will be 
          bound to.  For example, the following tooltip listens to 
          clicks on the window:</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">"Tooltip"</span>,{&#x000A;  <span class="string">"{window} click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span>&#x000A;    <span class="comment">// hide only if we clicked outside the tooltip</span>&#x000A;    <span class="keyword">if</span>(! <span class="keyword">this</span>.element.has(ev.target ) {&#x000A;      <span class="keyword">this</span>.element.remove();&#x000A;    }&#x000A;  }&#x000A;})&#x000A;&#x000A;<span class="comment">// create a Tooltip</span>&#x000A;<span class="keyword">new</span> Tooltip( $(<span class="string">'&lt;div&gt;INFO&lt;/div&gt;'</span>).appendTo(el) )&#x000A;</code></pre>
          
          <p>This is convenient when needing to 
          listen to model updates.  Instead of adding a callback
          to <code>todo.destroy(cb)</code>, we should be listening to 
          <strong>destroyed</strong> events.  We'll handle <strong>updated</strong> too:</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{&#x000A;  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span>&#x000A;    <span class="keyword">this</span>.element.html(<span class="string">'todos.ejs'</span>, Todo.findAll() )&#x000A;  },&#x000A;  <span class="string">"li click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(li)</span>{</span>&#x000A;    li.trigger(<span class="string">'selected'</span>, li.model() );&#x000A;  },&#x000A;  <span class="string">"li .destroy click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span>&#x000A;    el.closest(<span class="string">'.todo'</span>)&#x000A;      .model()&#x000A;      .destroy();&#x000A;    ev.stopPropagation();&#x000A;  },&#x000A;  <span class="string">"{Todo} destroyed"</span> : <span class="function"><span class="keyword">function</span><span class="params">(Todo, ev, destroyedTodo)</span>{</span>&#x000A;    destroyedTodo.elements(<span class="keyword">this</span>.element)&#x000A;                 .remove();&#x000A;  },&#x000A;  <span class="string">"{Todo} updated"</span> : <span class="function"><span class="keyword">function</span><span class="params">(Todo, ev, updatedTodo)</span>{</span>&#x000A;    updatedTodo.elements(<span class="keyword">this</span>.element)&#x000A;               .replaceWith(<span class="string">'todos.ejs'</span>,[updatedTodo]);&#x000A;  }&#x000A;})&#x000A;&#x000A;<span class="keyword">new</span> Todos(<span class="string">"#todos"</span>);&#x000A;</code></pre>
          
          <p>This is better because it removes the todo's element from the page even if another widget
          destroyed the todo. Also, this works very well with real-time
          architectures.</p>
          
          <h3>destroy <code>controller.destroy()</code></h3>
          
          <p><a href="#%21jQuery.Controller.prototype.destroy">$.Controller.prototype.destroy</a> unbinds a controller's
          event handlers and releases its element, but does not remove 
          the element from the page. </p>
          
          <pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todos(<span class="string">"#todos"</span>)&#x000A;todo.destroy();&#x000A;</code></pre>
          
          <p>When a controller's element is removed from the page
          <strong>destroy</strong> is called automatically.</p>
          
          <pre><code class=" javascript"><span class="keyword">new</span> Todos(<span class="string">"#todos"</span>)&#x000A;$(<span class="string">"#todos"</span>).remove();&#x000A;</code></pre>
          
          <p>All event handlers bound with Controller are unbound when the controller 
          is destroyed (or its element is removed).</p>
          
          <p><em>Brief aside on destroy and templated event binding. Taken 
          together, templated event binding, and controller's automatic
          clean-up make it almost impossible 
          to write leaking applications. An application that uses
          only templated event handlers on controllers within the body
          could free up all 
          data by calling <code>$(document.body).empty()</code>.</em></p>
          
          <h3>update <code>controller.update(options)</code></h3>
          
          <p><a href="#%21jQuery.Controller.prototype.update">$.Controller.prototype.update</a> updates a controller's 
          <code>this.options</code> and rebinds all event handlers.  This is useful
          when you want to listen to a specific model:</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">'Editor'</span>,{&#x000A;  update : <span class="function"><span class="keyword">function</span><span class="params">(options)</span>{</span>&#x000A;    <span class="keyword">this</span>._super(options)&#x000A;    <span class="keyword">this</span>.setName();&#x000A;  },&#x000A;  <span class="comment">// a helper that sets the value of the input</span>&#x000A;  <span class="comment">// to the todo's name</span>&#x000A;  setName : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;    <span class="keyword">this</span>.element.val(<span class="keyword">this</span>.options.todo.name);&#x000A;  },&#x000A;  <span class="comment">// listen for changes in the todo</span>&#x000A;  <span class="comment">// and update the input</span>&#x000A;  <span class="string">"{todo} updated"</span> : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;    <span class="keyword">this</span>.setName();&#x000A;  },&#x000A;  <span class="comment">// when the input changes</span>&#x000A;  <span class="comment">// update the todo instance</span>&#x000A;  <span class="string">"change"</span> : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;    <span class="keyword">var</span> todo = <span class="keyword">this</span>.options.todo&#x000A;    todo.attr(<span class="string">'name'</span>,<span class="keyword">this</span>.element.val() )&#x000A;    todo.save();&#x000A;  }&#x000A;});&#x000A;&#x000A;<span class="keyword">var</span> todo1= <span class="keyword">new</span> Todo({id: <span class="number">6</span>, name: <span class="string">"trash"</span>}),&#x000A;    todo2 = <span class="keyword">new</span> Todo({id: <span class="number">6</span>, name: <span class="string">"dishes"</span>});&#x000A;&#x000A;<span class="comment">// create the editor;</span>&#x000A;<span class="keyword">var</span> editor = <span class="keyword">new</span> Editor(<span class="string">"#editor"</span>);&#x000A;&#x000A;<span class="comment">// show the first todo</span>&#x000A;editor.update({todo: todo1})&#x000A;&#x000A;<span class="comment">// switch it to the second todo</span>&#x000A;editor.update({todo: todo2});&#x000A;</code></pre>
          
          <p>Notice that because we are overwriting <code>update</code>, we must call <strong>_super</strong>.</p>
          
          <h2>Routing</h2>
          
          <p><a href="#%21jQuery.route">$.route</a> is the core of JavaScriptMVC's 
          routing functionality. It is a <a href="#%21jQuery.Observe">jQuery.Observe</a> that
          updates <code>window.location.hash</code> when it's properties change
          and updates its properties when <code>window.location.hash</code> 
          changes. It allows very sophisticated routing behavior ... too
          sophisticated for this guide. But, it also handles 
          the basics with ease.  </p>
          
          <p>Listen to routes in controller's with special "route" events like:</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">"Routing"</span>,{&#x000A;  <span class="string">"route"</span> : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;    <span class="comment">// matches empty hash, #, or #!</span>&#x000A;  },&#x000A;  <span class="string">"todos/:id route"</span> : <span class="function"><span class="keyword">function</span><span class="params">(data)</span>{</span>&#x000A;    <span class="comment">// matches routes like #!todos/5</span>&#x000A;  }&#x000A;})&#x000A;&#x000A;<span class="comment">// create routing controller</span>&#x000A;<span class="keyword">new</span> Routing(document.body);&#x000A;</code></pre>
          
          <p>The <code>route</code> methods get called back with the route <strong>data</strong>.  The 
          empty <code>"route"</code> will be called with no data. But, <code>"todos/:id route"</code>
          will be called with data like: <code>{id: 6}</code>.</p>
          
          <p>We can update the route by changing $.route's data like:</p>
          
          <pre><code class=" javascript">$.route.attr(<span class="string">'id'</span>,<span class="string">'6'</span>) <span class="comment">// location.hash = #!todos/6</span>&#x000A;</code></pre>
          
          <p>Or we can set the hash ourselves like</p>
          
          <pre><code class=" javascript"><span class="keyword">var</span> hash = $.route.url({id: <span class="number">7</span>}) <span class="comment">// #!todos/7</span>&#x000A;location.hash = hash;&#x000A;</code></pre>
          
          <p>The following enhances the Routing controller to listen for
          <code>".todo selected"</code> events and change the <code>$.route</code>.  When the
          $.route changes, it retrieves the todo from the server
          and updates the editor widget.</p>
          
          <pre><code class=" javascript">$.Controller(<span class="string">"Routing"</span>,{&#x000A;  init : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;    <span class="keyword">this</span>.editor = <span class="keyword">new</span> Editor(<span class="string">"#editor"</span>)&#x000A;    <span class="keyword">new</span> Todos(<span class="string">"#todos"</span>);&#x000A;  },&#x000A;  <span class="comment">// the index page</span>&#x000A;  <span class="string">"route"</span> : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;     $(<span class="string">"#editor"</span>).hide();&#x000A;  },&#x000A;  <span class="string">"todos/:id route"</span> : <span class="function"><span class="keyword">function</span><span class="params">(data)</span>{</span>&#x000A;    $(<span class="string">"#editor"</span>).show();&#x000A;    Todo.findOne(data, $.proxy(<span class="function"><span class="keyword">function</span><span class="params">(todo)</span>{</span>&#x000A;      <span class="keyword">this</span>.editor.update({todo: todo});&#x000A;    }, <span class="keyword">this</span>))&#x000A;  },&#x000A;  <span class="string">".todo selected"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev, todo)</span>{</span>&#x000A;    $.route.attr(<span class="string">'id'</span>,todo.id);&#x000A;  }&#x000A;});&#x000A;&#x000A;<span class="comment">// create routing controller</span>&#x000A;<span class="keyword">new</span> Routing(document.body);&#x000A;</code></pre>
          
          <p>The <strong>Routing</strong> controller is a traditional controller. It coordinates
          between the <code>$.route</code>, <code>Editor</code> and <code>Todos</code>.  <code>Editor</code> and <code>Todos</code>
          are traditional views, consuming models.</p>
          
          <p>If you can understand this, you understand 
          everything. Congrats!  <a href="http://staging.javascriptmvc.com/tutorials/rapidstart/todos.html">See it in action</a>.</p>
          
          <h2>FuncUnit</h2>
          
          <p>JavaScriptMVC uses <a href="#%21FuncUnit">FuncUnit</a> for testing.  FuncUnit provides an API for writing functional 
          tests that simulate clicks and keypresses a user would make.</p>
          
          <p>To create a FuncUnit test:</p>
          
          <ul>
          <li>Create a test file that steals funcunit and</li>
          <li>Create a funcunit.html page that steals your test file</li>
          </ul>
          
          <p>In the <strong>todos</strong> directory, make funcunit.html and add the following HTML:</p>
          
          <pre><code class=" javascript">&lt;html&gt;&#x000A;  &lt;head&gt;&#x000A;    &lt;link rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> &#x000A;      href=<span class="string">"../funcunit/qunit/qunit.css"</span> /&gt;&#x000A;    &lt;script type=<span class="string">'text/javascript'</span> &#x000A;      src=<span class="string">'../steal/steal.js?todos/funcunit.js'</span>&gt;&lt;/script&gt;&#x000A;  &lt;/head&gt;&#x000A;  &lt;body&gt;&#x000A;    &lt;h1 id=<span class="string">"qunit-header"</span>&gt;Todos Test Suite&lt;/h1&gt;&#x000A;    &lt;h2 id=<span class="string">"qunit-banner"</span>&gt;&lt;/h2&gt;&#x000A;    &lt;div id=<span class="string">"qunit-testrunner-toolbar"</span>&gt;&lt;/div&gt;&#x000A;    &lt;h2 id=<span class="string">"qunit-userAgent"</span>&gt;&lt;/h2&gt;&#x000A;    &lt;div id=<span class="string">"test-content"</span>&gt;&lt;/div&gt;&#x000A;    &lt;ol id=<span class="string">"qunit-tests"</span>&gt;&lt;/ol&gt;&#x000A;    &lt;div id=<span class="string">"qunit-test-area"</span>&gt;&lt;/div&gt;&#x000A;  &lt;/body&gt;&#x000A;&lt;/html&gt;&#x000A;</code></pre>
          
          <p>Now make <strong>funcunit.js</strong> and add the following:</p>
          
          <pre><code class=" javascript">steal(<span class="string">'funcunit'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;&#x000A;  module(<span class="string">'todos'</span>)&#x000A;&#x000A;  test(<span class="string">'todos test'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;    ok(<span class="literal">true</span>, <span class="string">"the test loads"</span>);&#x000A;  })&#x000A;&#x000A;})&#x000A;</code></pre>
          
          <p>Open <strong>funcunit.html</strong> in your browser.  One test passes.</p>
          
          <h3>Writing a test</h3>
          
          <p>We tell the test to open the todos page using <a href="#%21FuncUnit.open">S.open</a>:</p>
          
          <pre><code class=" javascript">S.open(<span class="string">"//todos/todos.html"</span>);&#x000A;</code></pre>
          
          <p>Once the page is open, we select the first todo and click it:</p>
          
          <pre><code class=" javascript">S(<span class="string">".todo:first"</span>).click();&#x000A;</code></pre>
          
          <p>S is a copy of jQuery's $ that adds FuncUnit's API. The editor input will 
          now appear.  Tell FuncUnit to wait for this using a <a href="#%21funcunit.waits">wait</a> command:</p>
          
          <pre><code class=" javascript">S(<span class="string">"#editor"</span>).val(<span class="string">"wake up"</span>, <span class="string">"First Todo added correctly"</span>);&#x000A;</code></pre>
          
          <p>The second parameter is an assertion message.</p>
          
          <p>Replace the test code within the steal callback with the following:</p>
          
          <pre><code class=" javascript">module(<span class="string">'todos'</span>, {&#x000A;  setup: <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;    S.open(<span class="string">"//todos/todos.html"</span>);&#x000A;  }&#x000A;})&#x000A;&#x000A;test(<span class="string">'open first todo'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>&#x000A;  S(<span class="string">".todo:first"</span>).click();&#x000A;  S(<span class="string">"#editor"</span>).val(<span class="string">"wake up"</span>, <span class="string">"First Todo added correctly"</span>);&#x000A;})&#x000A;</code></pre>
          
          <p>Reload <strong>funcunit.html</strong>.  You'll see the page open and run the test in a separate window.</p>
          
          <p>FuncUnit has the ability to provide code coverage stats.  <a href="http://javascriptmvc.com/tutorials/rapidstart/funcunit.html?steal[instrument]=jquery%2Cfuncunit%2Csteal%2Cdocumentjs%2C*%2Ftest%2C*_test.js%2Cmxui%2C*funcunit.js">Click</a> 
          the checkbox next to coverage to 
          see a coverage report.  81% isn't bad!  Click Todos.js to see a line by line breakdown.</p>
          
          <h3>Automation</h3>
          
          <p>To run these tests automated, run the following from the console:</p>
          
          <pre><code class=" javascript">.<span class="regexp">/js funcunit/</span>run selenium todos/funcunit.html&#x000A;</code></pre>
          
          <p>FuncUnit supports <a href="#%21funcunit.integrations">integration</a> with CI tools 
          like <a href="#%21funcunit.jenkins">Jenkins</a>, build tools like <a href="#%21funcunit.maven">maven</a>, 
          and running via the <a href="#%21funcunit.phantomjs">PhantomJS</a> headless browser.</p>
        </div>
      </div>
    </div>
    <script src="javascripts/jquery-1.6.4.min.js" type="text/javascript"></script>
    <script src="javascripts/jquerymx-3.2.custom.js" type="text/javascript"></script>
    <script src="javascripts/highlightjs/src/highlight.js" type="text/javascript"></script>
    <script src="javascripts/application.js" type="text/javascript"></script>
  </body>
</html>
